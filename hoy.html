<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0f17" />
  <title>La magia</title>
  <link rel="stylesheet" href="./styles.css?v=3" />
</head>

<body>
  <!-- Cortinas -->
  <div class="curtainOverlay" id="curtainOverlay" aria-hidden="true">
    <div class="curtainWrap">
      <div class="valance"></div>
      <div class="curtain left"></div>
      <div class="curtain right"></div>
    </div>
  </div>

  <main class="phone" role="main">
    <header class="top">
      <h1>ğŸª„ Bienvenida a la funciÃ³n</h1>
      <p class="sub">Cortinas arribaâ€¦</p>
    </header>

    <section class="card">
      <h2>La magia</h2>
      <p>Presiona el botÃ³n para iniciar la funciÃ³n âœ¨</p>

      <button class="btnWide" id="magicBtn" type="button">âœ¨ Iniciar la funciÃ³n</button>

      <div class="reveal" id="reveal">
        <p style="margin-top:12px;">
          ğŸ­ Ta-da! Esto es el inicio. AquÃ­ iremos construyendo cosas bonitas poco a poco.
        </p>
      </div>
    </section>

    <a class="btnWide" href="/index.html">â† Volver</a>

    <footer class="footer">
      <small>Hecho con cariÃ±o.</small>
    </footer>
  </main>

  <script>
    function runCurtains() {
      const overlay = document.getElementById("curtainOverlay");
      if (!overlay) return;

      // Si el telÃ©fono tiene "reducir movimiento", igual mostramos cortinas pero mÃ¡s rÃ¡pido
      const reduce = window.matchMedia("(prefers-reduced-motion: reduce)").matches;

      // Asegura que el navegador â€œregistreâ€ el estado inicial antes de abrir (mejor en mÃ³vil)
      overlay.classList.remove("open", "done");
      overlay.offsetHeight;

      const openDelay = reduce ? 0 : 60;
      const doneDelay = reduce ? 250 : 1350;
      const removeDelay = reduce ? 450 : 1700;

      setTimeout(() => overlay.classList.add("open"), openDelay);
      setTimeout(() => overlay.classList.add("done"), doneDelay);
      setTimeout(() => overlay.remove(), removeDelay);
    }

    function wireMagicButton() {
      const btn = document.getElementById("magicBtn");
      const reveal = document.getElementById("reveal");
      btn?.addEventListener("click", () => reveal?.classList.toggle("show"));
    }

    window.addEventListener("DOMContentLoaded", () => {
      runCurtains();
      wireMagicButton();
    });

    // iOS a veces â€œreciclaâ€ pÃ¡ginas (bfcache). Esto asegura que vuelva a funcionar bien.
    window.addEventListener("pageshow", (e) => {
      if (e.persisted) runCurtains();
    });
  </script>
</body>
</html>
